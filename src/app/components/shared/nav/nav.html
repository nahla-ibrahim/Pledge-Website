<div class="px-3 fixed z-50 top-5 w-full" [class.scrolled]="isScrolled()"
  [class.darkscroll]="isScrolled() && isDark()  ">

  <div class="container mx-auto px-5 border border-primary/30 dark:border-bg rounded-full "
    [class.navScroll]="isScrolled()">
    <div class="flex w-full items-center justify-between ">
      <img src="assets/logo.png" class=" h-16 " />
      <button class="lg:hidden text-2xl text-dark-primary dark:text-white cursor-pointer transition-colors duration-200"
        (click)="toggle()">
        <fa-icon [icon]="isOpen() ? close : bars"></fa-icon>
      </button>

      <!-- ////////////// Desktop //////////////// -->
      <ul class="hidden cursor-pointer text-sm  text-dark-primary lg:flex gap-8 items-center dark:text-white"
        [class.open]="isOpen()">
        <li class="hover:text-secondary transition-colors" routerLink="/">HOME</li>
        <li class="hover:text-secondary transition-colors" routerLink="/about">ABOUT</li>
        <li class="hover:text-secondary transition-colors" routerLink="/contactus">CONTACT US</li>
        <li class="relative group">
          <span class="flex items-center gap-1 hover:text-secondary
          transition-colors">
            SERVICES
            <fa-icon [icon]="angleDown" class="group-hover:rotate-180 transition-all"></fa-icon>
          </span>
          <ul class="absolute left-0 mt-3 w-44
           bg-white rounded-lg shadow-lg. dark:bg-primary
           opacity-0 invisible
           group-hover:opacity-100 group-hover:visible
           transition-all duration-200
           translate-y-2 group-hover:translate-y-0 overflow-hidden">
            <li>
              <a routerLink="/all/courses" class="block px-4 py-2 text-sm
                hover:bg-gray-100 dark:hover:bg-primary hover:text-secondary">
                Courses
              </a>
            </li>
            <li>
              <a routerLink="/all/workshops" class="block px-4 py-2 text-sm
                hover:bg-gray-100 dark:hover:bg-primary hover:text-secondary ">
                Workshop
              </a>
            </li>
            <li>
              <a routerLink="/all/internships" class="block px-4 py-2 text-sm
                hover:bg-gray-100 dark:hover:bg-primary hover:text-secondary">
                Internship
              </a>
            </li>
          </ul>
        </li>

        <li class="hover:text-secondary transition-colors" routerLink="/allinstructors">INSTRUCTORS</li>
        <fa-icon [icon]="search" class="hover:scale-110 transition-transform hover:text-secondary"
          (click)="openSearch()"></fa-icon>
        <fa-icon [icon]="isDark() ? sun : moon" (click)="darkMode()"
          class="hover:scale-110 transition-transform hover:text-secondary">
        </fa-icon>
      </ul>
    </div>
  </div>

  <!-- //////////// mobile ///////////// -->
  <div
    class="lg:hidden absolute top-full left-0 w-full bg-linear-to-b from-white to-bg dark:from-primary dark:to-dark-primary dark:text-white  rounded-2xl mt-2.5 opacity-0 -translate-y-2 pointer-events-none transition-all duration-300 ease-in-out border border-primary/30 z-10  dark:border-bg"
    [class.open]="isOpen()">
    <ul class="flex flex-col cursor-pointer text-sm items-center ">
      <li class=" border-b w-full p-5 border-primary/30 dark:border-bg " routerLink="/" (click)="openNewRoute()">HOME
      </li>
      <li class=" border-b w-full p-5 border-primary/30 dark:border-bg " (click)="openNewRoute()" routerLink="/about">
        ABOUT</li>
      <li class=" border-b w-full p-5 border-primary/30 dark:border-bg " (click)=" openNewRoute()"
        routerLink="/contactus">CONTACT US
      </li>

      <li class="relative group w-full">
        <span class="flex items-center gap-1  border-b w-full p-5 border-primary/30 dark:border-bg
          ">
          SERVICES
          <fa-icon [icon]="angleDown" (click)="toggleServices()">
          </fa-icon>
        </span>
        <ul class="opacity-0 absolute w-full 
           bg-linear-to-b to-bg/50 
          cursor-pointer text-sm  text-dark-primary 
         -translate-y-2
         pointer-events-none dark:to-dark-primary dark:text-white
         transition-opacity transition-transform
         duration-200 ease-out
" [class.openServices]="openServices()">
          <li (click)="openNewRoute()">
            <a class="block px-5 pt-6 pb-2 text-sm
                hover:bg-gray-100 hover:text-secondary dark:hover:bg-transparent" routerLink="/all/courses">
              Courses
            </a>
          </li>
          <li (click)="openNewRoute()">
            <a class="block px-5 py-2 text-sm
                hover:bg-gray-100 hover:text-secondary dark:hover:bg-transparent" routerLink="/all/workshops">
              Workshop
            </a>
          </li>
          <li class="border-b border-primary/30 dark:border-bg" (click)="openNewRoute()">
            <a class="block px-5 pb-6 pt-2 text-sm
                hover:bg-gray-100 hover:text-secondary dark:hover:bg-transparent" routerLink="/all/internships">
              Internship
            </a>
          </li>
        </ul>
      </li>

      <li class="border-b w-full p-5 border-primary/30 dark:border-bg " (click)="openNewRoute()"
        routerLink="/allinstructors">
        INSTRUCTORS</li>
      <div class="flex w-full justify-between gap-6 p-5 transition-colors">
        <fa-icon [icon]="search" (click)="openSearch()"></fa-icon>
        <fa-icon [icon]="isDark() ? sun : moon" (click)="darkMode()"></fa-icon>
      </div>
    </ul>
  </div>
</div>


<!-- search icon -->
@if (isSearchOpen) {
<div class="fixed inset-0 bg-black/40 backdrop-blur-sm z-50 flex items-start justify-center pt-24">

  <div class="bg-white dark:bg-dark-primary w-full max-w-xl rounded-2xl shadow-xl p-6 relative">

    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
        Search
      </h3>

      <button (click)="closeSearch()" class="text-gray-400 hover:text-red-500 text-xl">
        âœ•
      </button>
    </div>


    <div class="flex gap-3 items-center justify-center mb-6">
      @for (item of btn; track $index) {
      <button class="px-5 py-2 rounded-full text-sm font-medium
           
           transition " (click)=" reloadcourses(item)" [ngClass]="
            item === activeBtn()
              ? 'bg-white text-primary shadow-md shadow-primary/30'
              : 'bg-primary text-white shadow-md shadow-primary/30'">
        {{ item }}
      </button>}
    </div>

    <input type="text" [(ngModel)]="searchTerm" placeholder="Search for a course..." class="w-full mb-5 px-4 py-2 rounded-xl border
             focus:outline-none focus:ring-2 focus:ring-primary/40 " (input)="filteredCourses(searchTerm())" />

    <div class="space-y-4 max-h-80 overflow-y-auto pr-1">

      @for (course of courses(); track course.id) {
      <div class="flex gap-4 p-4 rounded-2xl
             bg-white dark:bg-white/5
             border border-gray-100 dark:border-white/10
             shadow-sm hover:shadow-md
             transition">

        <!-- Image -->
        <img [src]="course.image" alt="{{ course.title }}" class="w-20 h-20 rounded-xl object-cover flex-shrink-0" />

        <!-- Content -->
        <div class="flex-1 space-y-1">
          <h3 class="text-sm font-semibold text-gray-800 dark:text-gray-100">
            {{ course.title }}
          </h3>

          <p class="text-xs text-gray-500 dark:text-gray-400 line-clamp-2">
            {{ course.description }}
          </p>
          <p class="text-secondary font-medium mb-3"> {{course.discountPrice}} EGP <span
              class="line-through ms-3">{{course.price}}</span></p>
        </div>

        <div class=" flex items-center">
          <button class="text-sm px-5 py-2 rounded-full
                 bg-primary text-white
                 hover:bg-primary/90
                 shadow-sm transition cursor-pointer" (click)="enroll(course.id)"> Book Now</button>
        </div>
      </div>

      }
      @if (courses().length === 0) {
      <p class=" text-center text-sm text-gray-400">
        No courses found
      </p>
      }

    </div>

  </div>
</div>
}
