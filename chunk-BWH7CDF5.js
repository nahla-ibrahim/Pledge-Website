import{k as j,l as B,m as M}from"./chunk-JSZS4B6F.js";import{a as P}from"./chunk-4IADN7NX.js";import{a as $}from"./chunk-ZW5WDOAU.js";import{i as R,k as L}from"./chunk-E5CYZ6LK.js";import{$a as C,Ab as O,Fa as l,Nb as h,Oa as T,Ob as V,R as f,Sa as y,Ua as E,W as g,X as u,ab as v,bb as k,cb as _,db as b,ea as s,eb as m,fb as o,gb as n,hb as A,ka as N,lb as x,nb as d,pb as D,vb as F,yb as p}from"./chunk-NSE3MCFW.js";var I=class i{constructor(e){this.element=e}isIntersecting=h();observer;ngAfterViewInit(){let e={root:null,rootMargin:"100px",threshold:.1};this.observer=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting&&this.isIntersecting.emit()})},e),this.observer.observe(this.element.nativeElement)}ngOnDestroy(){this.observer&&this.observer.disconnect()}static \u0275fac=function(t){return new(t||i)(T(N))};static \u0275dir=E({type:i,selectors:[["","appInfinityScroll",""]],outputs:{isIntersecting:"isIntersecting"}})};function q(i,e){if(i&1&&(o(0,"option",6),p(1),n()),i&2){let t=e.$implicit;m("value",t),l(),O(" ",t," ")}}var w=class i{search=h();categoryChange=h();selectedCategory=V();categories=s(["Frontend","Backend","UI/UX","Mobile"]);searchFunction(e){this.search.emit(e)}changeCategory(e){this.categoryChange.emit(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=y({type:i,selectors:[["app-filter-and-search"]],inputs:{selectedCategory:[1,"selectedCategory"]},outputs:{search:"search",categoryChange:"categoryChange"},decls:9,vars:0,consts:[["search",""],["selectedCategory",""],[1,"relative","max-w-5xl","mx-auto","mt-6","mb-16","bg-white/80","dark:bg-dark/80","backdrop-blur-xl","rounded-3xl","shadow-2xl","p-6","flex","flex-col","md:flex-row","gap-4","dark:bg-bg"],["type","text","placeholder","Search courses...",1,"flex-1","px-6","py-4","rounded-2xl","border","border-gray-300","focus:ring-2","focus:ring-primary","outline-none","text-gray-800","placeholder:text-gray-500","dark:border-primary",3,"input"],[1,"px-6","py-4","rounded-2xl","border","border-gray-300","placeholder:text-gray-500","outline-none","text-gray-800","focus:ring-2","focus:ring-primary","dark:border-primary",3,"change"],["value","","selected",""],[3,"value"]],template:function(t,r){if(t&1){let a=x();o(0,"div",2)(1,"input",3,0),d("input",function(){g(a);let S=F(2);return u(r.searchFunction(S.value))}),n(),o(3,"select",4,1),d("change",function(){g(a);let S=F(4);return u(r.changeCategory(S.value))}),o(5,"option",5),p(6," all "),n(),_(7,q,2,2,"option",6,k),n()()}t&2&&(l(7),b(r.categories()))},dependencies:[M,j,B],encapsulation:2})};var z=(i,e)=>e.id;function H(i,e){if(i&1&&A(0,"app-courses-card",4),i&2){let t=e.$implicit,r=D();m("data",t)("type",r.type())}}function J(i,e){i&1&&(o(0,"h1",5),p(1," LOADING ... "),n())}function K(i,e){if(i&1){let t=x();o(0,"div",9),d("isIntersecting",function(){g(t);let a=D();return u(a.loadMore())}),n()}}function Q(i,e){i&1&&(o(0,"p",7),p(1," No more courses to show "),n())}var G=class i{router=f(L);route=f(R);type=s("courses");getServices=f($);allCourses=s([]);filterdCourses=s([]);search=s("");selectedCategory=s("");categories=s([]);page=s(0);loading=s(!1);hasMore=s(!0);ngOnInit(){this.route.paramMap.subscribe(e=>{this.type.set(e.get("type")),this.resetAndReload()})}enroll(e){this.router.navigate(["enroll",this.type(),e])}filterCourses(e,t,r){let a=r.filter(c=>(c.category==e||e=="")&&c.title.toLowerCase().includes(t.toLowerCase()));this.filterdCourses.set(a),console.log(this.filterdCourses())}changeCategory(e){this.filterCourses(e,this.search(),this.allCourses()),this.selectedCategory.set(e)}searchFunction(e){this.filterCourses(this.selectedCategory(),e,this.allCourses()),this.search.set(e)}loadMore(){if(this.loading()&&!this.hasMore())return;this.loading.set(!0);let e=this.page();try{this.getServices.getData().subscribe(t=>{let r=this.type(),a=t[r].slice(e*8,e*8+8);this.allCourses.set([...this.allCourses(),...a]),this.filterCourses(this.selectedCategory(),this.search(),this.allCourses()),t[r].length<=e*8+8&&this.hasMore.set(!1)}),this.page.set(e+1)}catch{}finally{setTimeout(()=>{this.loading.set(!1)},200)}}resetAndReload(){this.page.set(0),this.allCourses.set([]),this.hasMore.set(!0),this.loadMore()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=y({type:i,selectors:[["app-all-courses"]],decls:10,vars:4,consts:[[1,"bg-bg","bg-linear-to-t","from-white","to-bg","pt-24","pb-10","overflow-hidden","dark:from-dark-primary","dark:to-primary/70"],[1,"container","px-3","mx-auto"],[3,"search","categoryChange","selectedCategory"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-8","items-stretch"],[3,"data","type"],[1,"text-center","text-gray-500","my-6"],["appInfinityScroll",""],[1,"text-center","text-gray-500","my-8"],[1,"text-bg"],["appInfinityScroll","",3,"isIntersecting"]],template:function(t,r){t&1&&(o(0,"section",0)(1,"div",1)(2,"app-filter-and-search",2),d("search",function(c){return r.searchFunction(c)})("categoryChange",function(c){return r.changeCategory(c)}),n(),o(3,"div",3),_(4,H,1,2,"app-courses-card",4,z),n(),C(6,J,2,0,"h1",5),C(7,K,1,0,"div",6),C(8,Q,2,0,"p",7),n()(),A(9,"hr",8)),t&2&&(l(2),m("selectedCategory",r.selectedCategory()),l(2),b(r.filterdCourses()),l(2),v(r.loading()?6:-1),l(),v(r.hasMore()&&!r.loading()?7:-1),l(),v(r.hasMore()?-1:8))},dependencies:[P,I,M,w],encapsulation:2})};export{G as AllCourses};
